<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta charset="iso-8559-1"/>
    <meta name="description" content="Time of War is a fast-paced third-person shooter."/>
    <meta name="keywords" content="wars, online game, shooter, rpg, tanks"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Time of war</title>
    <link rel="stylesheet" type="text/css" href="css/css_principal_page.css"/>
    <link rel="icon" type="image/png" href="css/keys/images/bullet.png"/>
</head>
<body> 
    <div class="loader">
            Connecting...
    </div>
    <div id="part2">
        <!--<button onclick="finish();">putos</button>-->
        <!-- width="1532" height="715"-->
        <canvas class="ctx" width="1532" height="715" style="position:absolute; left:0px; border:1px solid #000; background-color:rgba(120, 120, 120 ,1);"></canvas>
        <canvas onClick="CheckWriteInputNo();" class="ctx-score" width="1532" height="715" style="position:absolute; left:0px; border:1px solid #000; background-color:transparent;"></canvas>     
        <div id="scoreboard" style="position: absolute; top:10px; left:1335px;">LEADERBOARD</div>
        <!--Positions of Scoreboard-->
        <div id="topPlace" class="t1" style="position: absolute; top:40px; left:1300px;">No one XD</div>
        <div id="topPlace" class="t2" style="position: absolute; top:70px; left:1300px;">No one XD</div>
        <div id="topPlace" class="t3" style="position: absolute; top:100px; left:1300px;">No one XD</div>
        <div id="topPlace" class="t4" style="position: absolute; top:130px; left:1300px;">No one XD</div>
        <div id="topPlace" class="t5" style="position: absolute; top:160px; left:1300px;">No one XD</div>
        <div class="chatclass" onClick="CheckWriteInputNo();" id="chat-text" style="width: 210px; height: 450px; overflow-y: scroll;">
        </div>
        <form class="chatclass2" id="chat-form">
            <input class="chatclass3" onClick="CheckWriteInput();" id ="chat-input" type="text" style="width: 220px;"/>
        </form>
        <!--
        LIFE-4
        DAMAGE-1
        RPM-0
        TANK SPEED-2
        BULLET SPEED-3
        CHARGER SIZE-5
        -->
        <div id="stats" style="position:absolute;left:-450px; top:533px;border:1px solid #000; background-color:transparent;">          
            <div id="life" style="position:absolute;">
                <div id="namelife" style="position:absolute; left:152px;top:5px;font-family:'Arial';font-weight: bold;font-size:12px;">LIFE</div>
                <div id="imagelife">
                <img src="css/keys/images/stat0.png" width="330" height="25">                    
                </div>
                <button class="circlebutton2" id="buttonlife" onClick="var b = changeStats(4); return b" style="position:absolute;left:335px;top:1px;font-family:'Arial';font-weight: bold;font-size:18px;">+</button> 
            </div>
            <div id="tankspeed" style="position:absolute;top:30px;">
                <div id="nametankspeed" style="position:absolute; left:126px;top:5px;font-family:'Arial';font-weight: bold;font-size:12px;">TANK SPEED</div>
                <div id="imagetankspeed">
                <img src="css/keys/images/stat0.png"  width="330" height="25">                    
                </div>
                <button class="circlebutton2" id="buttontankspeed" onClick="var b = changeStats(2); return b" style="position:absolute;left:335px;top:1px;font-family:'Arial';font-weight: bold;font-size:18px;">+</button>                 
            </div>
            <div id="damage" style="position:absolute;top:60px;">
                <div id="namedamage" style="position:absolute; left:140px;top:5px;font-family:'Arial';font-weight: bold;font-size:12px;">DAMAGE</div>
                <div id="imagedamage">
                <img src="css/keys/images/stat0.png" width="330" height="25">                    
                </div>                
                <button class="circlebutton2" id="buttondamage" onClick="var b = changeStats(1); return b" style="position:absolute;left:335px;top:1px;font-family:'Arial';font-weight: bold;font-size:18px;">+</button>                 
            </div>
            <div id="rpm" style="position:absolute;top:90px;">
                <div id="namerpm" style="position:absolute; left:151px;top:5px;font-family:'Arial';font-weight: bold;font-size:12px;">RPM</div>
                <div id="imagerpm">
                <img src="css/keys/images/stat0.png" width="330" height="25">                    
                </div>                
                <button class="circlebutton2" id="buttonrpm" onClick="var b = changeStats(0); return b" style="position:absolute;left:335px;top:1px;font-family:'Arial';font-weight: bold;font-size:18px;">+</button>                 
            </div>
            <div id="bulletspeed" style="position:absolute;top:120px;">
                <div id="namebulletspeed" style="position:absolute; left:122px;top:5px;font-family:'Arial';font-weight: bold;font-size:12px;">BULLET SPEED</div>
                <div id="imagebulletspeed">
                <img src="css/keys/images/stat0.png" width="330" height="25">                    
                </div>
                <button class="circlebutton2" id="buttonbulletspeed" onClick="var b = changeStats(3); return b" style="position:absolute;left:335px;top:1px;font-family:'Arial';font-weight: bold;font-size:18px;">+</button> 
            </div>
            <div id="chargersize" style="position:absolute;top:150px;">
                <div id="namechargersize" style="position:absolute; left:121px;top:5px;font-family:'Arial';font-weight: bold;font-size:12px;">CHARGER SIZE</div>
                <div id="imagechargersize">
                <img src="css/keys/images/stat0.png" width="330" height="25">                    
                </div>
                <button class="circlebutton2" id="buttonchargersize" onClick="var b = changeStats(5); return b" style="position:absolute;left:335px;top:1px;font-family:'Arial';font-weight: bold;font-size:18px;">+</button> 
            </div>                                       
        </div>
    </div>
    <div id="part1">
        <aside class="leftaside">
            <div class="h1container">   
                <h1>TimeOfWar.io</h1>
                <div class="bullet">
                    <img src="css/keys/images/bullet.png" width="15" height="25">
                </div>
            </div>
            <div class="leftasideweapon">
                <header>
                    <div class="headerleftasidecontainer">
                        <span>WEAPON TYPE</span>
                    </div>
                </header>
                <div class="weaponconfig">
                    <aside class="leftarrow">
                        <button class="leftarrowbutton" onClick="var b = play(); left_weapon(); return b"></button>
                    </aside>
                    <div class="weaponcontainer" style="margin-left:50px;">
                        <section class="weapon">
                        </section>
                    </div>
                    <aside class="rightarrow">
                        <button class="rightarrowbutton" onClick="var b = play(); right_weapon(); return b"></button>
                    </aside>
                    <footer class="weaponname">
                    </footer>
                </div>
                <div class="stats">
                    INITIAL STATS
                </div>
                <div class="weaponstats">
                    <div>
                        <span class="range">BULLET SPEED</span><br>
                        <div>
                            <canvas class="rangebarcanvas" width="430" height="10" style="margin-left:5px;"></canvas>
                        </div>
                    </div>
                    <div>
                        <span class="rpm">RPM</span><br>
                        <div>
                            <canvas class="rpmbarcanvas" width="430" height="10" style="margin-left:5px;"></canvas>                        
                        </div>
                    </div>
                    <div>
                        <span class="damage">DAMAGE</span><br>
                        <div>
                            <canvas class="damagebarcanvas" width="430" height="10" style="margin-left:5px;"></canvas>                        
                        </div>                    
                    </div>
                    <div>
                        <span class="charger">CHARGER SIZE</span>                                                                                      
                        <div>
                            <canvas class="chargerbarcanvas" width="430" height="10" style="margin-left:5px;"></canvas>                        
                        </div>                    
                    </div>
                </div>
            </div>
        </aside>
        <div class="center">     
            <header class="centerheader">
                <div class="logo">              
                    <img src="css/keys/images/logo.png" width="400" height="240"/>
                </div>
                <div class="start"> 
                    <section class="playername">
                        <label>PLAYER NAME</label>
                        <input maxlength="16" class="inputname" type="text" name="nameplayer"/>
                    </section> 
                    <section>
                        <button class="startbutton" onClick="var b = play(); start(); return b">START GAME</button>
                    </section> 
                    <section class="imagecenter">
                        <img src="css/keys/images/player.png" width="200" height="130"/>
                    </section> 
                    <section>
                        <button class="tutorialbutton" onClick="var b = play(); 
                        tutorial('id1');
                        tutorial('id2');
                        tutorial('id3');                    
                        return b">TUTORIAL</button>
                        <!-- Appear and disappear -->
                        <div id="id1" class="tutorial" style=" 
                            text-align:center; 
                            font-weight:bold; 
                            font-size:36px; 
                            font:Arial, Helvetica, sans-serif;">
                        </div>
                        <div id="id2" class="tutorial" style="
                            text-align:left; 
                            font-weight:bold;
                            font-size: 22px;
                            top:140px;
                            padding-left: 15px;
                            width:605px;
                            font:Arial, Helvetica, sans-serif;">
                        </div>
                        <div id="id3" class="tutorial" style="
                            text-align:center;
                            height:27px;                        
                            top:475px;
                            width:595px;
                            margin-left:0px;
                            border: none;">
                        </div>                                               
                    </section>                                  
                </div>
            </header>
        </div>
        <aside class="rightaside">
            <div class="socialmediacontainer">
                <div class="socialmedia">
                    Follow us in social media!
                </div>
                <div class="fbcontainer">
                    <button class="fb" onclick=" window.open('https://www.facebook.com/rodrigo.teran.127','_blank')"></button>
                </div>
            </div>
            <div class="player">
                <header class="headerleftasidecontainer"> 
                    CUSTOMIZE YOUR PLAYER
                </header>
                <div class="playercontainer">
                    <div class="weaponconfig"> 
                        <div class="weaponcontainer" style="margin-left:60px;"> 
                            <section class="weapon"> 
                            </section>
                        </div>
                        <section>
                            <button class="greentank" onClick="var b = play(); change_color(0); return b">
                            </button>
                            
                            <button class="redtank" onClick="var b = play(); change_color(1); return b">
                            </button>
                            
                            <button class="bluetank" onClick="var b = play(); change_color(2); return b">
                            </button>                                                
                        </section>
                        <footer class="weaponname" style="margin-top:7px;">
                            TANK COLOR
                        </footer>
                    </div>
                </div>
            </div>
            <div class="ad">
                <p class="realad">SPACE FOR ADS</p>
            </div>        
        </aside> 
        <footer class="finalfooter">                                         
        </footer>
    </div>
    <script type="text/javascript" src="https://cdn.socket.io/socket.io-1.4.5.js"> // Sockets
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"> // JQuery libary
    </script> 
    <script type="text/javascript"> // loading page
    $(window).load(function() {
        $(".loader").fadeOut("slow");
        document.getElementById("part1").style.display = 'block';
    });
    </script>
    <script type="text/javascript">
        // función que actualiza el zoom del elemento body
        function actualizarTama(){
        $("body").css("zoom", window.innerWidth / 1530);
        };
        $(document).ready(function(){
            // actualizaremos el zoom cuando la ventana cambie de tamaño
            $(window).on("resize", actualizarTama);
            // y al cargar la página
            actualizarTama();  
        });
        var detStats = 0;
        var animaStats = function(){
            var stats = document.getElementById("stats");
            if(detStats == 0){
                detStats = 1;
                stats.className = 'statsi';
            }else{ 
                stats.className = 'stats2';
                detStats = 0;
            };
        };
        // --------------------------------------------------------------------VARIABLES
        var names_of_weapon_list = ["SINGLE SHOT", "MACHINE GUN", "BOMB"];
        var superlist = [
            ['<img src="css/keys/tanks/side_tanks/red/st0.png" width="160" height="100"/>',  // red
            '<img src="css/keys/tanks/side_tanks/red/st1.png" width="160" height="100"/>',
            '<img src="css/keys/tanks/side_tanks/red/st2.png" width="160" height="100"/>'],
            
            ['<img src="css/keys/tanks/side_tanks/green/st0.png" width="160" height="100"/>',  // green
            '<img src="css/keys/tanks/side_tanks/green/st1.png" width="160" height="100"/>',
            '<img src="css/keys/tanks/side_tanks/green/st2.png" width="160" height="100"/>'],
            
            ['<img src="css/keys/tanks/side_tanks/blue/st0.png" width="160" height="100"/>',  // blue
            '<img src="css/keys/tanks/side_tanks/blue/st1.png" width="160" height="100"/>',
            '<img src="css/keys/tanks/side_tanks/blue/st2.png" width="160" height="100"/>'],
        ];
        var superlist_2 = [
            ["css/keys/tanks/red/r_b.png",  // red
            "css/keys/tanks/red/r_b.png",
            "css/keys/tanks/red/r_b.png"],
            
            ["css/keys/tanks/green/g_b.png",  // green
            "css/keys/tanks/green/g_b.png",
            "css/keys/tanks/green/g_b.png"],
            
            ["css/keys/tanks/blue/b_b.png",  // blue
            "css/keys/tanks/blue/b_b.png",
            "css/keys/tanks/blue/b_b.png"],
        ];  
        var superlist_3 = [
            ["css/keys/tanks/red/r_1.png",  // red
            "css/keys/tanks/red/r_2.png",
            "css/keys/tanks/red/r_0.png"],
            
            ["css/keys/tanks/green/g_1.png",  // green
            "css/keys/tanks/green/g_2.png",
            "css/keys/tanks/green/g_0.png"],
            
            ["css/keys/tanks/blue/b_1.png",  // blue
            "css/keys/tanks/blue/b_2.png",
            "css/keys/tanks/blue/b_0.png"],
        ];
        var superlistposition = 0;  // COLOR
        var insidelistposition = 0;  // WEAPON

        // CANVAS
        var ctx_range = document.getElementsByClassName("rangebarcanvas")[0].getContext("2d");
        var ctx_rpm = document.getElementsByClassName("rpmbarcanvas")[0].getContext("2d");
        var ctx_damage = document.getElementsByClassName("damagebarcanvas")[0].getContext("2d");
        var ctx_charger_size = document.getElementsByClassName("chargerbarcanvas")[0].getContext("2d"); 
        var width_range = 0;
        var width_rpm = 0;
        var width_damage = 0;
        var width_charger = 0;
        var howmuch_range = 0;
        var howmuch_rpm = 0;
        var howmuch_damage = 0;
        var howmuch_charger = 0;
        // CANVAS

        // Check speed navigator
        var is_chrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;
        var is_firefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;
        var is_opera = navigator.userAgent.toLowerCase().indexOf('opera');              
        // Check speed navigator

        // Variable play audio
        var audio = new Audio("css/keys/sounds/sound_1.mp3");
                
        // --------------------------------------------------------------------FUNCTIONS 1
        function play(){
            audio.play();
        };      
        function change_weapon(){
            write_();   //write and draw weapon
            change_stats();     //canvas
            clear();    //clear the stats before this ones, then call draw()
        };
        function right_weapon(){            // Call outside change weapon
            if(insidelistposition == 2){
                insidelistposition = 0;
            }
            else{
                insidelistposition += 1;
            };
            change_weapon();
        };
        function left_weapon(){         // Call outside change weapon
            if(insidelistposition == 0){
                insidelistposition = 2;
            }
            else{
                insidelistposition -= 1;
            };
            change_weapon();
        };          
        function change_color(color){           // Call outside change color
            // green, red, blue
            if(color == 0){
                superlistposition = 1;
            };
            if(color == 1){
                superlistposition = 0;              
            };
            if(color == 2){
                superlistposition = 2;              
            };
            write_();               
        };      
        function write_(){
            document.getElementsByClassName("weaponname")[0].innerHTML=names_of_weapon_list[insidelistposition];    //write weapon name
            document.getElementsByClassName("weapon")[0].innerHTML=know_tank(); //draw tank (weapon side)
            document.getElementsByClassName("weapon")[1].innerHTML=know_tank(); // draw tank (color side)
        };
        function know_tank(){   //know what tank to draw first page 
            var color_position = superlist[superlistposition];
            var actual_tank = color_position[insidelistposition];
            return actual_tank;
        };
        function know_tank_2(){   //know what tank to draw game
            var color_position = superlist_2[superlistposition];
            var actual_tank = color_position[insidelistposition];
            return actual_tank;
        };
        function know_tank_3(){   //know what tank's weapon to draw
            var color_position = superlist_3[superlistposition];
            var actual_tank = color_position[insidelistposition];
            return actual_tank;
        }; 
        function change_stats(){
            if(insidelistposition == 0){    //"SINGLE SHOT"
                howmuch_range = 350;
                howmuch_rpm = 210;
                howmuch_damage = 120;
                howmuch_charger = 150;
            };
            if(insidelistposition == 1){    //"MACHINE GUN"
                howmuch_range = 250;
                howmuch_rpm = 400;
                howmuch_damage = 70;
                howmuch_charger = 200;
            };
            if(insidelistposition == 2){    //"BOMB"
                howmuch_range = 100;
                howmuch_rpm = 50;
                howmuch_damage = 400;
                howmuch_charger = 50;
            };              
        };
        function draw(){
            ctx_range.fillStyle = "#00274F";
            ctx_range.fillRect(0, 0, width_range, 10);
            ctx_rpm.fillStyle = "#00274F";
            ctx_rpm.fillRect(0, 0, width_rpm, 10);
            ctx_damage.fillStyle = "#00274F";
            ctx_damage.fillRect(0, 0, width_damage, 10);
            ctx_charger_size.fillStyle = "#00274F";
            ctx_charger_size.fillRect(0, 0, width_charger, 10);
            if(width_range <= howmuch_range){
                width_range += 10;
            };
            if(width_charger <= howmuch_charger){
                width_charger += 10;
            };
            if(width_rpm <= howmuch_rpm){
                width_rpm += 10;
            };
            if(width_damage <= howmuch_damage){
                width_damage += 10;
            };
        };
        function check_navigator(){
            if(is_firefox){
                speed = 15;
                return speed;
            };
            if(is_opera){
                speed = 15;
                return speed;
            };
            if(is_chrome){
                speed = 15;
                return speed;
            };
            if (document.documentMode || /Edge/.test(navigator.userAgent)) {
                speed = .1;
                return speed;
            };
        };
        function clear(){
            width_range = 0;
            width_rpm = 0;
            width_damage = 0;
            width_charger = 0;
            ctx_range.clearRect(0, 0, 420, 10);
            ctx_rpm.clearRect(0, 0, 420, 10);
            ctx_damage.clearRect(0, 0, 420, 10);
            ctx_charger_size.clearRect(0, 0, 420, 10);
            draw();
        };
        function tutorialbutton(){
            var b = play(); tutorial("id1"); tutorial("id2"); tutorial("id3"); 
            return b;
        };
        function tutorial(id){  //hide and show the tutorial section
            var margin_top_final_footer = document.getElementsByClassName("finalfooter")[0];
            var new_block = document.getElementById(id);
            if(new_block.className == ''){
                margin_top_final_footer.style.marginTop = '135px';
            }else{
                margin_top_final_footer.style.marginTop = '135px';
            };  
            if(new_block.className == 'tutorial'){
                new_block.className = '';
                document.getElementById(id).innerHTML="";
            }else{
                new_block.className = 'tutorial';
                if(id == "id1"){
                    document.getElementById(id).innerHTML='TUTORIAL';
                };      
                if(id == "id2"){
                    document.getElementById(id).innerHTML=
                    'The game is a FFA tank war<br>'+
                    'The game consist of attacking other players and gain score to get to the top position<br>'+
                    'You gain the score of the tank you have eliminated and +1 coin<br>'+
                    'Also, you cain gain coins through collecting coin items, +1 coin per item<br>'+
                    'The bullet item fill your bullet capacity<br>'+
                    'And the life item fill your life capacity<br>'+
                    'Keys:<br>'+
                    'r: Open chat<br>'+
                    'r: Open shop<br>'+
                    'And...<br>'+
                    '...if you die, you loose all your score...<br>';
                };
                if(id == "id3"){
                    document.getElementById(id).innerHTML='<button class="backbutton" onClick="tutorialbutton();">Got it bro!';
                };
            };
        };
        // --------------------------------------------------------------------FUNCTIONS 2
        var ctx = document.getElementsByClassName("ctx")[0].getContext("2d");
        var DetGame = false;
        var socket = io(); // Sends package connection to the server

        function getname_(){
            var nameplayer = document.getElementsByName("nameplayer")[0].value;
            return nameplayer;
        };
        var SignIn = function(){
            socket.emit("SignIn", {
                username:getname_(),
                tankColor:know_tank_2(),
                tankWeapon:know_tank_3(),
            })
        };
        function start2(){
            $("#part2").fadeIn("slow");
        };
        function start(){  //hide the main page and show game
            $("#part1").fadeOut("slow");
            start2();
            SignIn();
            DetGame = true;
        };
        function finish2(){
            $("#part1").fadeIn("slow");
        };
        function finish(){  //hide the game and show main page
            $("#part2").fadeOut("slow");
            finish2();
        };
        var new_block = document.getElementById("chat-text");  
        var new_block_2 = document.getElementById("chat-form"); 
        var new_block_3 = document.getElementById("chat-input");
        function chatHideShow(){
            if(new_block.className == 'chatclass'){
                new_block.className = '';
                new_block_2.className = '';
                new_block_3.className = '';

                new_block.style.display = "none"; 
                new_block_2.style.display = "none"; 
                new_block_3.style.display = "none"; 
            }else{
                new_block.style.display = "block"; 
                new_block_2.style.display = "block"; 
                new_block_3.style.display = "block"; 

                new_block.className = 'chatclass';
                new_block_2.className = 'chatclass2';
                new_block_3.className = 'chatclass3';
            };
        };
        // --------------------------------------------------------------------CALL INITIAL FUNCTIONS
        tutorial('id1');
        tutorial('id2');
        tutorial('id3'); 
        write_();
        chatHideShow();
        setInterval(draw, check_navigator());
        change_stats();
        draw();
        // --------------------------------------------------------------------ONLINE GAME LOGIC
        // --------------------------------------------------------------------FUNCTIONS
        var WIDTH = 1532;
        var HEIGHT = 715;

        var Img = {};
        Img.player = new Image();
        Img.playerW = new Image();        
        Img.bullet = new Image();
        Img.items = new Image();      
        Img.map = {};
        var angle = 0;
        var messageScore = "No one XD";

        Img.map["map1"] = new Image();
        Img.map["map1"].src = "/client/css/keys/images/map1.png";

        Img.map["map2"] = new Image();
        Img.map["map2"].src = "/client/css/keys/images/map1.png";        

        var ctxUi = document.getElementsByClassName("ctx-score")[0].getContext("2d");
        var chatText = document.getElementById("chat-text");
        var chatInput = document.getElementById("chat-input");
        var chatForm = document.getElementById("chat-form");

        var Player = function(initPack){
            var self = {};
            self.id = initPack.id;
            self.number = initPack.number;
            self.tankColor = initPack.tankColor;
            self.tankWeapon  = initPack.tankWeapon;
            self.x = initPack.x;
            self.y = initPack.y;          
            self.hp = initPack.hp;
            self.chargersize = initPack.chargersize;
            self.angleChasis = initPack.angleChasis;
            self.chargerNow = initPack.chargerNow;
            self.hpMax = initPack.hpMax;
            self.mouseAngle = initPack.mouseAngle;
            self.score = initPack.score;
            self.map = initPack.map;
            self.money = initPack.money;
            self.username = initPack.username;

            self.draw = function(){
                function drawImageR(context, image, sx, sy, swidth, sheight, x, y, width_i, height_i, angle, det){
                    context.save();
                    if(det == 0){
                        context.translate(x + (width_i / 2), y + (height_i / 2));
                        context.rotate((angle*Math.PI)/180);
                        context.drawImage(image, sx, sy, swidth, sheight, (-width_i / 2), (-height_i / 2), width_i, height_i);
                        context.restore();
                    }else{
                        context.translate((x-29) + (width_i / 2), (y+60) + (height_i / 2));
                        context.rotate((angle*Math.PI)/180);
                        context.drawImage(image, sx, sy, swidth, sheight, (-width_i / 2 + width_i/4), (-height_i / 2 - height_i/2 + 10), width_i, height_i);
                        context.restore();
                    };
                };                
                Img.player.src = self.tankColor;
                Img.playerW.src = self.tankWeapon;                
                ctx.fillStyle = "black";
                ctx.font = "15px Arial";
                if(Player.list[selfId].map !== self.map){
                    return;
                };
                var x = self.x - Player.list[selfId].x + WIDTH/2;
                var y = self.y - Player.list[selfId].y + HEIGHT/2;

                var hpWidth = 50 * self.hp / self.hpMax;
                var hpWidth2 = 800 * self.hp / self.hpMax;
                if(self.id == Player.list[selfId].id){
                    ctx.fillStyle = "green";
                    ctx.fillRect(x - hpWidth2/2, y + 330, hpWidth2, 15);    // Own player
                }else{
                    ctx.fillStyle = "red";
                    ctx.fillRect(x - hpWidth/2, y + 40, hpWidth, 4);    // Everyone player
                };
                
                var width = Img.player.width/4;
                var height = Img.player.height/4;    

                var widthW = Img.playerW.width/2;
                var heightW = Img.playerW.height/5;

                drawImageR(ctx, Img.player, 0,0,Img.player.width, Img.player.height, x-width/2, y-height/2, width, height, self.angleChasis, 0);
                drawImageR(ctx, Img.playerW, 0,0,Img.player.width, Img.player.height, x-widthW/2 + 29, y-heightW/2 - 60, widthW, heightW, self.mouseAngle +90, 1);
                var name = "";
                if(self.username == ""){
                    name = "An unnamed tank";
                }else{
                    name = self.username;
                };
                ctx.fillStyle = "black";
                ctx.font = "15px Arial";
                var widthText = ctx.measureText(name).width;
                ctx.fillText(name, x - widthText/2, y - 30);

                ctx.fillStyle = "black";
                ctx.font = "30px Arial"; 
                var money = "Money: " + Player.list[selfId].money;
                ctx.fillText(money, 0, 100);
                // Leaderboard
                var arrScore = function(names){
                    function compare(a,b){
                        return b.score - a.score;
                    };
                    names.sort(compare);
                    return names;
                };
                function sortObject(){
                    var clients = [];
                    var detOrder = 0;
                    for(var i in Player.list){
                        if(Player.list[i].map == Player.list[selfId].map){
                            var name = Player.list[i].username;
                            if(name == ""){
                                name = "An unnamed tank";
                            };
                            var object = {
                                score:Player.list[i].score,
                                user:name,
                            }
                            clients.push(object);
                        };
                        detOrder ++;
                    };
                    return arrScore(clients);
                };
                var SCORES = sortObject();
                //console.log(SCORES[0].user + ": " + SCORES[0].score);
                var top1 = document.getElementsByClassName("t1")[0];
                var top2 = document.getElementsByClassName("t2")[0];
                var top3 = document.getElementsByClassName("t3")[0];
                var top4 = document.getElementsByClassName("t4")[0];
                var top5 = document.getElementsByClassName("t5")[0];
                top1.innerHTML = SCORES[0].user + ": " + SCORES[0].score;
                if(SCORES.length == 1){
                    top2.innerHTML = messageScore;
                    top3.innerHTML = messageScore;
                    top4.innerHTML = messageScore;
                    top5.innerHTML = messageScore;
                };                
                if(SCORES.length == 2){
                    top2.innerHTML = SCORES[1].user + ": " + SCORES[1].score;
                    top3.innerHTML = messageScore;
                    top4.innerHTML = messageScore;
                    top5.innerHTML = messageScore;
                };
                if(SCORES.length == 3){
                    top2.innerHTML = SCORES[1].user + ": " + SCORES[1].score;
                    top3.innerHTML = SCORES[2].user + ": " + SCORES[2].score;
                    top4.innerHTML = messageScore;
                    top5.innerHTML = messageScore;                 
                };
                if(SCORES.length == 4){
                    top2.innerHTML = SCORES[1].user + ": " + SCORES[1].score;
                    top3.innerHTML = SCORES[2].user + ": " + SCORES[2].score;
                    top4.innerHTML = SCORES[3].user + ": " + SCORES[3].score;
                    top5.innerHTML = messageScore;
                };
                if(SCORES.length >= 5){
                    top2.innerHTML = SCORES[1].user + ": " + SCORES[1].score;
                    top3.innerHTML = SCORES[2].user + ": " + SCORES[2].score;
                    top4.innerHTML = SCORES[3].user + ": " + SCORES[3].score;
                    top5.innerHTML = SCORES[4].user + ": " + SCORES[4].score;
                };
            };
            Player.list[self.id] = self;
            return self;
        };

        Player.list = {};
        var Bullet = function(initPack){
            var self = {};
            self.id = initPack.id;
            self.x = initPack.x;
            self.y = initPack.y;
            self.map = initPack.map;
            self.bulletSrc = initPack.bulletSrc;

            self.draw = function(){
                if(Player.list[selfId].map !== self.map){
                    return;
                };
                var width = Img.bullet.width/10;
                var height = Img.bullet.height/10;

                var x = self.x - Player.list[selfId].x + WIDTH/2;
                var y = self.y - Player.list[selfId].y + HEIGHT/2;

                Img.bullet.src = self.bulletSrc;

                ctx.drawImage(Img.bullet, 0,0,Img.bullet.width, Img.bullet.height, 
                    x-width/2, y-height/2, width, height);
            };
            Bullet.list[self.id] = self;
            return self;
        };
        Bullet.list = {};
        var Items = function(initPack){
            var self = {};
            self.id = initPack.id;
            self.x = initPack.x;
            self.y = initPack.y;
            self.map = initPack.map;
            self.Src = initPack.Src;

            self.draw = function(){
                if(Player.list[selfId].map !== self.map){
                    return;
                };
                Img.items.src = self.Src;
                var width = Img.items.width/5;
                var height = Img.items.height/5;

                var x = self.x - Player.list[selfId].x + WIDTH/2;
                var y = self.y - Player.list[selfId].y + HEIGHT/2;

                ctx.drawImage(Img.items, 0,0,Img.items.width, Img.items.height, 
                    x-width/2, y-height/2, width, height);
            };
            Items.list[self.id] = self;
            return self;          
        };
        Items.list = {};

        var selfId = null;
        socket.on("init", function(data){
            if(data.selfId)
                selfId = data.selfId;
            for(var i = 0; i < data.player.length; i++){
                new Player(data.player[i]);
            };
            for(var i = 0; i < data.bullet.length; i++){
                new Bullet(data.bullet[i]);
            };   
            for(var i = 0; i < data.item.length; i++){
                new Items(data.item[i]);
            };                  
        });
        socket.on("update", function(data){
            for(var i = 0; i< data.player.length; i++){
                var pack = data.player[i];
                var p = Player.list[pack.id];
                if(p){
                    if(pack.x !== undefined)
                        p.x = pack.x;
                    if(pack.y !== undefined)
                        p.y = pack.y;
                    if(pack.hp !== undefined)
                        p.hp = pack.hp;             
                    if(pack.score !== undefined)
                        p.score = pack.score;
                    if(pack.mouseAngle !== undefined)
                        p.mouseAngle = pack.mouseAngle;   
                    if(pack.angleChasis !== undefined)
                        p.angleChasis = pack.angleChasis;       
                    if(pack.hpMax !== undefined)
                        p.hpMax = pack.hpMax;     
                    if(pack.chargersize !== undefined)
                        p.chargersize = pack.chargersize;       
                    if(pack.chargerNow !== undefined)
                        p.chargerNow = pack.chargerNow;
                    if(pack.money !== undefined)
                        p.money = pack.money;                    
                };
            };
            for(var i = 0; i< data.bullet.length; i++){
                var pack = data.bullet[i];
                var b = Bullet.list[data.bullet[i].id];
                if(b){
                    if(pack.x !== undefined)
                        b.x = pack.x;
                    if(pack.y !== undefined)
                        b.y = pack.y;           
                };
            };
            for(var i = 0; i< data.item.length; i++){
                var pack = data.item[i];
                var b = Items.list[data.item[i].id];
                if(b){
                    if(pack.x !== undefined)
                        b.x = pack.x;
                    if(pack.y !== undefined)
                        b.y = pack.y;           
                };
            };               
        });
        socket.on("remove", function(data){
            for(var i = 0; i < data.player.length; i++){
                delete Player.list[data.player[i]];
            };
            for(var i = 0; i < data.bullet.length; i++){
                delete Bullet.list[data.bullet[i]];
            };
            for(var i = 0; i < data.item.length; i++){
                delete Items.list[data.item[i]];
            };            
        });
        setInterval(function(){
            if(!selfId)
                return;
            if(DetGame == false){
                return;
            }else{
                ctx.clearRect(0, 0, 1532, 715);
                drawMap();
                drawScore();
                drawCharger();
                SHOP();
                for(var i in Bullet.list){
                    Bullet.list[i].draw();
                };                  
                for(var i in Player.list){
                    Player.list[i].draw();
                }; 
                for(var i in Items.list){
                    Items.list[i].draw();
                };                 
            };   
        }, 40);
        var drawMap = function(){
            var player = Player.list[selfId];
            var x = WIDTH/2 - player.x;
            var y = HEIGHT/2 - player.y;
            ctx.drawImage(Img.map[player.map], x, y);
        };
        var listOfStats = [0,0,0,0,0,0];
        var SiNo = 0;
        var SHOP = function(){
            var myMoney = Player.list[selfId].money;

            var buttonrpm = document.getElementById("buttonrpm");
            var buttondamage = document.getElementById("buttondamage");
            var buttontankspeed = document.getElementById("buttontankspeed");
            var buttonbulletspeed = document.getElementById("buttonbulletspeed");
            var buttonlife = document.getElementById("buttonlife");
            var buttonchargersize = document.getElementById("buttonchargersize");
            
            buttonrpm.disabled = true;
            buttondamage.disabled = true;
            buttontankspeed.disabled = true;
            buttonbulletspeed.disabled = true;
            buttonlife.disabled = true;
            buttonchargersize.disabled = true;

            buttonrpm.className = "circlebutton2";
            buttondamage.className = "circlebutton2";
            buttontankspeed.className = "circlebutton2";
            buttonbulletspeed.className = "circlebutton2";
            buttonlife.className = "circlebutton2";
            buttonchargersize.className = "circlebutton2";

            var compra = 0;

            if(myMoney >= 5){
                if(listOfStats[0] == 0){
                    buttonrpm.disabled = false;
                    buttonrpm.className = "circlebutton";
                    compra = 1; 
                };
                if(listOfStats[1] == 0){
                    buttondamage.disabled = false;
                    buttondamage.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[2] == 0){
                    buttontankspeed.disabled = false;
                    buttontankspeed.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[3] == 0){
                    buttonbulletspeed.disabled = false;
                    buttonbulletspeed.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[4] == 0){
                    buttonlife.disabled = false;
                    buttonlife.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[5] == 0){
                    buttonchargersize.disabled = false;
                    buttonchargersize.className = "circlebutton";
                    compra = 1;
                };                                                                                
            };
            if(myMoney >= 15){
                if(listOfStats[0] == 1){
                    buttonrpm.disabled = false;
                    buttonrpm.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[1] == 1){
                    buttondamage.disabled = false;
                    buttondamage.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[2] == 1){
                    buttontankspeed.disabled = false;
                    buttontankspeed.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[3] == 1){
                    buttonbulletspeed.disabled = false;
                    buttonbulletspeed.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[4] == 1){
                    buttonlife.disabled = false;
                    buttonlife.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[5] == 1){
                    buttonchargersize.disabled = false;
                    buttonchargersize.className = "circlebutton";
                    compra = 1;
                };                                                                                
            };
            if(myMoney >= 30){
                if(listOfStats[0] == 2){
                    buttonrpm.disabled = false;
                    buttonrpm.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[1] == 2){
                    buttondamage.disabled = false;
                    buttondamage.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[2] == 2){
                    buttontankspeed.disabled = false;
                    buttontankspeed.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[3] == 2){
                    buttonbulletspeed.disabled = false;
                    buttonbulletspeed.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[4] == 2){
                    buttonlife.disabled = false;
                    buttonlife.className = "circlebutton";
                    compra = 1;
                };
                if(listOfStats[5] == 2){
                    buttonchargersize.disabled = false;
                    buttonchargersize.className = "circlebutton";
                    compra = 1;
                };                                                                           
            };
            if(compra == 1){
                if(SiNo == 0){
                    animaStats();
                    SiNo = 1;
                };
            };
        };
        var drawScore = function(){
            ctxUi.fillStyle = "black";
            ctxUi.font = "30px Arial";         
            if(lastScore === Player.list[selfId].score){
                return;
            };
            lastScore = Player.list[selfId].score;
            ctxUi.clearRect(0, 0, 1532, 715);
            var realScore = "Score: " + Player.list[selfId].score;
            ctxUi.fillText(realScore, 0, 30);
            var widthText = ctx.measureText("LIFE").width;
            ctxUi.fillText("LIFE", WIDTH/2 - widthText/2, 680);  
            ctxUi.fillText("Bullets: " + Player.list[selfId].chargerNow + "/" + Player.list[selfId].chargersize, 0, 65);                 
        };
        var lastScore = null;
        var drawCharger = function(){
            ctxUi.fillStyle = "black";
            ctxUi.font = "30px Arial";         
            if(lastCharger === Player.list[selfId].chargerNow){
                return;
            };
            lastCharger = Player.list[selfId].chargerNow;
            ctxUi.clearRect(0, 0, 1532, 715);
            var realScore = "Score: " + Player.list[selfId].score;
            ctxUi.fillText(realScore, 0, 30);
            var widthText = ctx.measureText("LIFE").width;
            ctxUi.fillText("LIFE", WIDTH/2 - widthText/2, 680);              
            ctxUi.fillText(realScore, 0, 30);   
            ctxUi.fillText("Bullets: " + Player.list[selfId].chargerNow + "/" + Player.list[selfId].chargersize, 0, 65);   
        };
        var lastCharger = null;      
        var lastMoney = null;      

        socket.on("addToChat", function(data, map){
            if(map == Player.list[selfId].map){
                chatText.innerHTML += "<div>" + data + "</div>";                
            };
        });
        socket.on("evalAnswer", function(data){
            console.log(data);
        });
        socket.on("Die", function(data){
            if(data.id == Player.list[selfId].id){
                finish();
            };  
        });
        chatForm.onsubmit = function(e){
            e.preventDefault();
            socket.emit("sendMsgToServer", chatInput.value);
            chatInput.value = "";
        };
        var detChatTusa = true;
        var CheckWriteInput= function(){
            detChatTusa = false;
        };
        var CheckWriteInputNo= function(){
            detChatTusa = true;
        };        
        document.onkeydown = function(event){
            var player = Player.list[selfId];
            if(detChatTusa == true){
                if(DetGame == true){
                    if(event.keyCode === 65)   //a
                        socket.emit("keyPress", {inputId:"left", state:true});
                    else if(event.keyCode === 68)    //d
                        socket.emit("keyPress", {inputId:"right", state:true}); 
                    else if(event.keyCode === 87)   //w
                        socket.emit("keyPress", {inputId:"up", state:true}); 
                    else if(event.keyCode === 83)   //s
                        socket.emit("keyPress", {inputId:"down", state:true});                                         
                    if(event.keyCode === 84)    //t
                        chatHideShow();             
                    if(event.keyCode === 82)    //r
                        animaStats();                    
                };
            };
        };
        document.onkeyup = function(event){
            if(detChatTusa == true){
                if(DetGame == true){
                    if(event.keyCode === 68)    //d
                        socket.emit("keyPress", {inputId:"right", state:false});
                    else if(event.keyCode === 83)   //s
                        socket.emit("keyPress", {inputId:"down", state:false});
                    else if(event.keyCode === 65)   //a
                        socket.emit("keyPress", {inputId:"left", state:false});
                    else if(event.keyCode === 87)   //w
                        socket.emit("keyPress", {inputId:"up", state:false});
                };                        
            };
        };  
        document.onmousedown = function(event){
            if(DetGame == true){
                socket.emit("keyPress", {inputId:"attack", state:true})
            };
        };
        document.onmouseup = function(event){
            if(DetGame == true){
                socket.emit("keyPress", {inputId:"attack", state:false})
            };
        };
        document.onmousemove = function(event){
            if(DetGame == true){
                var x = -766 + event.clientX - 8;
                var y = -358 + event.clientY - 8;       
                angle = Math.atan2(y, x) / Math.PI * 180;
                socket.emit("keyPress", {inputId:"mouseAngle", state:angle})
            };
        };
        document.oncontextmenu = function(event){
            event.preventDefault();
        };
        socket.on("SiNo", function(){
            SiNo = 0;
        });
        var changeStats = function(det){
            if(det == 0){   //Rpm
                var image = document.getElementById("imagerpm");
                var button = document.getElementById("buttonrpm");
                image.innerHTML='';
                if(listOfStats[0] == 0){
                    image.innerHTML='<img src="css/keys/images/stat1.png"  width="330" height="25">';
                    listOfStats[0] = 1;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 5;
                    socket.emit("changestats", {
                        name:"rpm",
                        level:1,
                    });
                }
                else if(listOfStats[0] == 1){
                    image.innerHTML='<img src="css/keys/images/stat2.png"  width="330" height="25">';
                    listOfStats[0] = 2;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 15;
                    socket.emit("changestats", {
                        name:"rpm",
                        level:2,
                    });                   
                }
                else if(listOfStats[0] == 2){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';
                    listOfStats[0] = 3;
                    button.className = "circlebutton2";  
                    button.style.cursor = "default";
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 30;
                    socket.emit("changestats", {
                        name:"rpm",
                        level:3,
                    });                   
                }
                else if(listOfStats[0] == 3){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';
                };                                                      
            };
            if(det == 1){ //Damage
                var image = document.getElementById("imagedamage");
                var button = document.getElementById("buttondamage");
                image.innerHTML='';
                if(listOfStats[1] == 0){
                    image.innerHTML='<img src="css/keys/images/stat1.png"  width="330" height="25">';
                    listOfStats[1] = 1;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 5;
                    socket.emit("changestats", {
                        name:"damage",
                        level:1,
                    });           
                }
                else if(listOfStats[1] == 1){
                    image.innerHTML='<img src="css/keys/images/stat2.png"  width="330" height="25">';                   
                    listOfStats[1] = 2;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 15;
                    socket.emit("changestats", {
                        name:"damage",
                        level:2,
                    });                      
                }
                else if(listOfStats[1] == 2){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';                    
                    listOfStats[1] = 3;
                    button.className = "circlebutton2";  
                    button.style.cursor = "default";
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 30;
                    socket.emit("changestats", {
                        name:"damage",
                        level:3,
                    });                      
                }
                else if(listOfStats[1] == 3){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';           
                };  
            };            
            if(det == 2){ //Tank speed
                var image = document.getElementById("imagetankspeed");
                var button = document.getElementById("buttontankspeed");
                image.innerHTML='';
                if(listOfStats[2] == 0){
                    image.innerHTML='<img src="css/keys/images/stat1.png"  width="330" height="25">';                   
                    listOfStats[2] = 1;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 5;
                    socket.emit("changestats", {
                        name:"tankspeed",
                        level:1,
                    });                      
                }
                else if(listOfStats[2] == 1){
                    image.innerHTML='<img src="css/keys/images/stat2.png"  width="330" height="25">';                  
                    listOfStats[2] = 2;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 15;
                    socket.emit("changestats", {
                        name:"tankspeed",
                        level:2,
                    });                      
                }
                else if(listOfStats[2] == 2){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';                   
                    listOfStats[2] = 3;
                    button.className = "circlebutton2";  
                    button.style.cursor = "default";                    
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 30;
                    socket.emit("changestats", {
                        name:"tankspeed",
                        level:3,
                    });                                          
                }
                else if(listOfStats[2] == 3){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';         
                };  
            };
            if(det == 3){ //Bulet speed
                var image = document.getElementById("imagebulletspeed");
                var button = document.getElementById("buttonbulletspeed");
                image.innerHTML='';
                if(listOfStats[3] == 0){
                    image.innerHTML='<img src="css/keys/images/stat1.png"  width="330" height="25">';                   
                    listOfStats[3] = 1;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 5;
                    socket.emit("changestats", {
                        name:"bulletspeed",
                        level:1,
                    });                      
                }
                else if(listOfStats[3] == 1){
                    image.innerHTML='<img src="css/keys/images/stat2.png"  width="330" height="25">';
                    listOfStats[3] = 2;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 15;
                    socket.emit("changestats", {
                        name:"bulletspeed",
                        level:2,
                    });                        
                }
                else if(listOfStats[3] == 2){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';
                    listOfStats[3] = 3;
                    button.className = "circlebutton2";  
                    button.style.cursor = "default";
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 30;
                    socket.emit("changestats", {
                        name:"bulletspeed",
                        level:3,
                    });                        
                }
                else if(listOfStats[3] == 3){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';               
                };  
            };
            if(det == 4){ //Life
                var image = document.getElementById("imagelife");
                var button = document.getElementById("buttonlife");
                image.innerHTML='';
                if(listOfStats[4] == 0){
                    image.innerHTML='<img src="css/keys/images/stat1.png"  width="330" height="25">';           
                    listOfStats[4] = 1;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 5;
                    socket.emit("changestats", {
                        name:"life",
                        level:1,
                    });                        
                }
                else if(listOfStats[4] == 1){
                    image.innerHTML='<img src="css/keys/images/stat2.png"  width="330" height="25">';                
                    listOfStats[4] = 2;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 15;
                    socket.emit("changestats", {
                        name:"life",
                        level:2,
                    });                       
                }
                else if(listOfStats[4] == 2){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';             
                    listOfStats[4] = 3;
                    button.className = "circlebutton2";  
                    button.style.cursor = "default";
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 30;
                    socket.emit("changestats", {
                        name:"life",
                        level:3,
                    });                       
                }
                else if(listOfStats[4] == 3){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';               
                };  
            };
            if(det == 5){ //charger size
                var image = document.getElementById("imagechargersize");
                var button = document.getElementById("buttonchargersize");
                image.innerHTML='';
                if(listOfStats[5] == 0){
                    image.innerHTML='<img src="css/keys/images/stat1.png"  width="330" height="25">';           
                    listOfStats[5] = 1;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 5;
                    socket.emit("changestats", {
                        name:"chargersize",
                        level:1,
                    });                        
                }
                else if(listOfStats[5] == 1){
                    image.innerHTML='<img src="css/keys/images/stat2.png"  width="330" height="25">';                   
                    listOfStats[5] = 2;
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 15;
                    socket.emit("changestats", {
                        name:"chargersize",
                        level:2,
                    });                       
                }
                else if(listOfStats[5] == 2){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';
                    listOfStats[5] = 3;
                    button.className = "circlebutton2";  
                    button.style.cursor = "default";
                    play();
                    Player.list[selfId].money =Player.list[selfId].money - 30;
                    socket.emit("changestats", {
                        name:"chargersize",
                        level:3,
                    });                       
                }
                else if(listOfStats[5] == 3){
                    image.innerHTML='<img src="css/keys/images/stat3.png"  width="330" height="25">';               
                };  
            };  
            socket.emit("changeMoney", {newMoney:Player.list[selfId].money});
        };
    </script>
</body>
</html>
